<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>LIAM BURGER - Carta 70's</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Carta retro 70's de LIAM BURGER - Delivery de hamburguesas, pizzas, lomos, milanesas y patys." />
  <link href="https://fonts.googleapis.com/css2?family=Special+Elite&family=Oswald:wght@900&display=swap" rel="stylesheet" />
  <style>
  :root{
    --fondo:#f5f0e1;
    --letra:#2b2b2b;
    --amarillo:#ffc72c;
    --rojo:#e4002b;
    --fuente-tit:'Special Elite',serif;
    --fuente-cuerpo:'Oswald',sans-serif;
  }
  *{box-sizing:border-box;margin:0;padding:0;}
  body{background:var(--fondo);color:var(--letra);font-family:var(--fuente-cuerpo);font-weight:700;letter-spacing:.5px;}
  header{position:relative;text-align:center;padding:2rem 1rem 1.5rem;background:var(--amarillo);border-bottom:4px solid var(--rojo);overflow:hidden;}
  header .fondoCarrusel{position:absolute;inset:0;z-index:0;display:flex;animation:slideInfinito 13.68s infinite linear;}
  header .fondoCarrusel img{width:100%;height:100%;object-fit:cover;opacity:.25;flex-shrink:0;}
  @keyframes slideInfinito{0%{transform:translateX(0)}100%{transform:translateX(-100%)}}
  header h1{position:relative;z-index:1;font-family:var(--fuente-tit);font-size:4.5rem;color:var(--rojo);text-transform:uppercase;letter-spacing:3px;text-shadow:3px 3px 0 #000;font-weight:900;}
  header p{position:relative;z-index:1;margin-top:.5rem;font-size:1.2rem;}
  .accordion{width:100%;max-width:100%;margin:auto;padding:0 0 1rem;position:relative;}
  .accordion.ofertas-accordion{padding:0 0 1rem;}
  .accordion input{position:absolute;opacity:0;z-index:-1;}
  .accordion-label{position:relative;display:flex;justify-content:space-between;align-items:center;padding:1rem;font-family:var(--fuente-tit);font-size:1.84rem;background:var(--amarillo);border-bottom:3px solid var(--rojo);cursor:pointer;z-index:2;overflow:hidden;font-weight:900;}
  .accordion-label.ofertas{background:var(--rojo);color:var(--amarillo);font-size:2.07rem;font-weight:900;}
  .labelImagen{position:absolute;inset:0;z-index:-1;width:100%;height:100%;object-fit:cover;opacity:1;}
  .section-background{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;overflow:hidden;opacity:0;transition:opacity 0.5s ease;}
  .accordion input:checked ~ .section-background{opacity:1;}
  .section-background .carrusel{position:absolute;top:0;left:0;width:100%;height:100%;}
  .section-background .carrusel img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;opacity:0;animation:fadeImages 12s infinite;}
  .section-background .carrusel img:nth-child(1){animation-delay:0s;}
  .section-background .carrusel img:nth-child(2){animation-delay:3s;}
  .section-background .carrusel img:nth-child(3){animation-delay:6s;}
  .section-background .carrusel img:nth-child(4){animation-delay:9s;}
  @keyframes fadeImages{
    0%,20%{opacity:1;transition: opacity 1s ease-in-out;}
    25%,95%{opacity:0;transition: opacity 1s ease-in-out;}
    100%{opacity:1;}
  }
  .section-overlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(245,240,225,0);z-index:2;}
  .accordion-label::after{content:"+";font-size:1.8rem;transition:transform .3s;z-index:2;color:var(--rojo);background:rgba(255,255,255,0.7);width:30px;height:30px;display:flex;align-items:center;justify-content:center;border-radius:50%;}
  .accordion-label.ofertas::after{color:var(--amarillo);background:rgba(0,0,0,0.3);}
  .accordion input:checked + .accordion-label::after{transform:rotate(45deg);}
  .accordion-content{max-height:0;overflow:hidden;transition:max-height .4s ease;padding:0 1rem;position:relative;z-index:3;background:rgba(245,240,225,0.8);}
  .accordion input:checked ~ .accordion-content{max-height:2000px;padding:1rem 0;}
  .item{display:flex;align-items:flex-start;justify-content:space-between;padding:.5rem 0;border-bottom:1px dashed var(--letra);background:rgba(255,255,255,0.6);margin-bottom:5px;border-radius:5px;padding:10px;}
  .itemNombre{flex:1;font-family:var(--fuente-tit);font-size:1.1rem;}
  .itemDesc{font-size:.8rem;font-weight:400;margin-top:.2rem;color:#444;}
  .puntos{border-bottom:2px dotted var(--letra);flex:1;margin:0 .5rem;opacity:.6;align-self:center;}
  .precioBox{background:#000;color:var(--amarillo);padding:.2rem .6rem;border-radius:4px;font-weight:700;font-size:1.3rem;white-space:nowrap;align-self:center;}
  .btnAgregar{background:var(--rojo);color:#fff;border:none;padding:.3rem .6rem;border-radius:4px;margin-left:.5rem;cursor:pointer;font-family:var(--fuente-cuerpo);transition:background 0.2s;align-self:center;}
  .btnAgregar:hover{background:#c20023;}
  .carrito{position:fixed;bottom:1rem;right:1rem;background:#000;color:var(--amarillo);padding:.7rem 1rem;border-radius:30px;font-weight:700;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.3);z-index:1000;transition:transform 0.2s;}
  .carrito:hover{transform:scale(1.05);}
  .carrito span{background:var(--amarillo);color:#000;border-radius:50%;padding:.2rem .5rem;margin-left:.3rem;}
  .editarBtn{position:fixed;bottom:1rem;right:8.5rem;background:var(--rojo);color:#fff;border:none;padding:.4rem .8rem;border-radius:20px;font-weight:700;cursor:pointer;display:none;z-index:1000;transition:background 0.2s;transform: translateY(0);}
  .editarBtn:hover{background:#b0001f;}
  .editarBtn.visible{display:block;animation:fadeIn 0.3s ease-in-out;}
  @keyframes fadeIn{
    from{opacity:0;transform: translateY(10px);}
    to{opacity:1;transform: translateY(0);}
  }
  .totalBadge{position:fixed;bottom:1rem;left:1rem;background:var(--amarillo);color:#000;padding:.4rem .8rem;border-radius:20px;font-weight:700;z-index:1000;box-shadow:0 2px 5px rgba(0,0,0,0.2);}
  footer{position:relative;z-index:1;text-align:center;padding:2rem 1rem;font-size:.8rem;font-family:var(--fuente-tit);margin-top:2rem;}
  /* Modal confirmación */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:9999;}
  .modal.oculto{display:none;}
  .modalContent{background:var(--fondo);padding:1.5rem 2rem;border-radius:8px;text-align:center;font-family:var(--fuente-tit);max-width:90%;box-shadow:0 4px 20px rgba(0,0,0,0.3);}
  .modalContent h3{margin-bottom:1rem;font-size:1.3rem;color:var(--rojo);}
  .modalContent button{margin:.5rem;padding:.5rem 1rem;font-size:1rem;border:none;border-radius:4px;cursor:pointer;transition:background 0.2s;}
  .modalContent .si{background:var(--rojo);color:#fff;}
  .modalContent .si:hover{background:#c20023;}
  .modalContent .no{background:#ccc;color:#000;}
  .modalContent .no:hover{background:#bbb;}
  /* Editor carrito */
  .editorModal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:9999;}
  .editorModal.oculto{display:none;}
  .editorContent{background:var(--fondo);padding:1.5rem;border-radius:8px;max-width:400px;width:90%;max-height:70vh;overflow-y:auto;font-family:var(--fuente-cuerpo);box-shadow:0 4px 20px rgba(0,0,0,0.3);}
  .editorContent h3{margin-bottom:1rem;font-family:var(--fuente-tit);color:var(--rojo);}
  .editorItem{display:flex;justify-content:space-between;align-items:center;margin-bottom:.5rem;padding:0.5rem;background:rgba(0,0,0,0.05);border-radius:4px;}
  .editorItem button{background:#000;color:var(--amarillo);border:none;padding:.2rem .5rem;border-radius:4px;cursor:pointer;transition:background 0.2s;}
  .editorItem button:hover{background:#333;}
  
  /* Estilo para la leyenda de patys */
  .leyendaPatys{background:rgba(255,199,44,0.7);color:#e4002b;padding:0.8rem;margin-top:1rem;border-radius:8px;text-align:center;font-weight:900;font-size:1rem;box-shadow:0 2px 5px rgba(0,0,0,0.2);}
  
  /* Estilo para separador de categorías */
  .separadorCategoria{margin:1rem 0;text-align:center;font-family:var(--fuente-tit);font-size:1.2rem;color:var(--rojo);font-weight:900;}
  
  /* Estilos para productos no disponibles */
  .item.no-disponible {
    opacity: 0.6;
    background: rgba(255, 200, 200, 0.3);
  }
  
  .no-disponible-label {
    background: var(--rojo);
    color: white;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.8rem;
    font-weight: bold;
    margin-top: 5px;
    display: inline-block;
  }
  
  /* Mejoras para móviles */
  @media (max-width: 600px) {
    header h1{font-size:3.5rem;}
    .accordion-label{font-size:1.4rem;}
    .itemNombre{font-size:1rem;}
    .precioBox{font-size:1.1rem;}
    .editarBtn{right:7.5rem;}
  }
  </style>
  
  <!-- Redirección para Decap CMS -->
  <script>
    if (window.location.pathname === '/admin/') {
      window.location.href = '/admin/index.html';
    }
  </script>
</head>
<body>

<header>
  <div class="fondoCarrusel" id="headerCarrusel">
    <!-- Las imágenes se cargarán dinámicamente con JavaScript -->
  </div>
  <h1>LIAM BURGER</h1>
  <p>Pedidos: (383) 461-9831</p>
</header>

<!-- OFERTAS -->
<div class="accordion ofertas-accordion" id="ofertas-section">
  <input type="checkbox" id="ofertas">
  <label for="ofertas" class="accordion-label ofertas">OFERTAS</label>
  <div class="section-background">
    <div class="carrusel" id="ofertasCarrusel">
      <!-- Las imágenes se cargarán dinámicamente con JavaScript -->
    </div>
    <div class="section-overlay"></div>
  </div>
  <div class="accordion-content">
    <!-- Los productos se cargarán dinámicamente desde Decap CMS -->
  </div>
</div>

<!-- PIZZAS -->
<div class="accordion" id="pizzas-section">
  <input type="checkbox" id="pizzas" checked>
  <label for="pizzas" class="accordion-label">
    Pizzas
    <img class="labelImagen" src="images/pizza_1.jpg" alt="pizza">
  </label>
  <div class="section-background">
    <div class="carrusel" id="pizzaCarrusel">
      <!-- Las imágenes se cargarán dinámicamente con JavaScript -->
    </div>
    <div class="section-overlay"></div>
  </div>
  <div class="accordion-content">
    <!-- Los productos se cargarán dinámicamente desde Decap CMS -->
  </div>
</div>

<!-- LOMOS -->
<div class="accordion" id="lomos-section">
  <input type="checkbox" id="lomos">
  <label for="lomos" class="accordion-label">
    Lomos
    <img class="labelImagen" src="images/lomo_1.jpg" alt="lomo">
  </label>
  <div class="section-background">
    <div class="carrusel" id="lomoCarrusel">
      <!-- Las imágenes se cargarán dinámicamente con JavaScript -->
    </div>
    <div class="section-overlay"></div>
  </div>
  <div class="accordion-content">
    <!-- Los productos se cargarán dinámicamente desde Decap CMS -->
  </div>
</div>

<!-- MILANESAS -->
<div class="accordion" id="milas-section">
  <input type="checkbox" id="milas">
  <label for="milas" class="accordion-label">
    Milanesas
    <img class="labelImagen" src="images/mila_1.jpg" alt="mila">
  </label>
  <div class="section-background">
    <div class="carrusel" id="milaCarrusel">
      <!-- Las imágenes se cargarán dinámicamente con JavaScript -->
    </div>
    <div class="section-overlay"></div>
  </div>
  <div class="accordion-content">
    <!-- Los productos se cargarán dinámicamente desde Decap CMS -->
  </div>
</div>

<!-- ZAPPIN Y PAPAS -->
<div class="accordion" id="zappin-section">
  <input type="checkbox" id="zappin">
  <label for="zappin" class="accordion-label">
    Zappin y Papas
    <img class="labelImagen" src="images/hamb_4.jpg" alt="zappin">
  </label>
  <div class="section-background">
    <div class="carrusel" id="hambCarrusel">
      <!-- Las imágenes se cargarán dinámicamente con JavaScript -->
    </div>
    <div class="section-overlay"></div>
  </div>
  <div class="accordion-content">
    <!-- Los productos se cargarán dinámicamente desde Decap CMS -->
    <div class="separadorCategoria">PAPAS</div>
  </div>
</div>

<!-- PATYS -->
<div class="accordion" id="patys-section">
  <input type="checkbox" id="patys">
  <label for="patys" class="accordion-label">
    Patys
    <img class="labelImagen" src="images/patys_1.jpg" alt="patys">
  </label>
  <div class="section-background">
    <div class="carrusel" id="patysCarrusel">
      <!-- Las imágenes se cargarán dinámicamente con JavaScript -->
    </div>
    <div class="section-overlay"></div>
  </div>
  <div class="accordion-content">
    <!-- Los productos se cargarán dinámicamente desde Decap CMS -->
    <div class="leyendaPatys">¡Todo con papas + pote de mayo!</div>
  </div>
</div>

<!-- CARRITO + EDITAR + TOTAL -->
<div class="totalBadge" id="totalBadge">Total: $0</div>
<div class="editarBtn" id="editarBtn" onclick="mostrarEditor()">Editar</div>
<div class="carrito" onclick="enviarWhatsApp()">
  🛒 Pedir por WhatsApp <span id="carritoCant">0</span>
</div>

<footer>
  LIAM BURGER · Alsina Sur · (383) 461-9831 · Todos los días
</footer>

<!-- MODALES -->
<div id="modalConfirm" class="modal oculto">
  <div class="modalContent">
    <h3>¿Agregar al carrito?</h3>
    <button class="si" onclick="confirmarSi()">Sí</button>
    <button class="no" onclick="confirmarNo()">No</button>
  </div>
</div>

<div id="editorModal" class="editorModal oculto">
  <div class="editorContent">
    <h3>Editar carrito</h3>
    <div id="editorLista"></div>
    <button class="btnAgregar" onclick="cerrarEditor()">Cerrar</button>
  </div>
</div>

<script>
const NUMERO_WHATSAPP = 543834619831;
let carrito = [];
let tempProducto = null;

// Función para verificar si una imagen existe
function imagenExiste(url) {
  return new Promise(resolve => {
    const img = new Image();
    img.onload = () => resolve(true);
    img.onerror = () => resolve(false);
    img.src = url;
  });
}

// Función para cargar imágenes existentes en un carrusel
async function cargarImagenesCarrusel(contenedorId, prefijo, max = 6) {
  const contenedor = document.getElementById(contenedorId);
  const imagenesValidas = [];
  
  // Verificar qué imágenes existen
  for (let i = 1; i <= max; i++) {
    const url = `images/${prefijo}_${i}.jpg`;
    if (await imagenExiste(url)) {
      imagenesValidas.push(url);
    }
  }
  
  // Si no hay imágenes válidas, ocultar el carrusel
  if (imagenesValidas.length === 0) {
    contenedor.style.display = 'none';
    return;
  }
  
  // Cargar imágenes válidas en el carrusel
  if (contenedorId === 'headerCarrusel') {
    // Para el header, necesitamos duplicar las imágenes para el bucle infinito
    imagenesValidas.forEach(url => {
      const img = document.createElement('img');
      img.src = url;
      img.alt = url.split('/').pop().split('.')[0];
      contenedor.appendChild(img);
    });
    
    // Duplicar las imágenes para el bucle infinito
    imagenesValidas.forEach(url => {
      const img = document.createElement('img');
      img.src = url;
      img.alt = url.split('/').pop().split('.')[0];
      contenedor.appendChild(img);
    });
    
    // Ajustar la animación según la cantidad de imágenes
    const porcentaje = 100 / imagenesValidas.length;
    contenedor.style.animation = `slideInfinito ${13.68 * imagenesValidas.length / 6}s infinite linear`;
    document.documentElement.style.setProperty('--slide-distance', `-${porcentaje}%`);
  } else {
    // Para las secciones, cargar imágenes con animación de desvanecimiento
    imagenesValidas.forEach((url, index) => {
      const img = document.createElement('img');
      img.src = url;
      img.alt = url.split('/').pop().split('.')[0];
      img.style.animationDelay = `${index * 3}s`;
      contenedor.appendChild(img);
    });
    
    // Ajustar la duración de la animación según la cantidad de imágenes
    const duracion = 3 * imagenesValidas.length;
    Array.from(contenedor.children).forEach(img => {
      img.style.animationDuration = `${duracion}s`;
    });
  }
}

// Función para cargar productos desde Decap CMS
async function cargarProductos() {
  try {
    // Cargar las secciones del menú
    const menuResponse = await fetch('_data/menu.json');
    const menuData = await menuResponse.json();
    
    // Ordenar secciones según el campo "order"
    const seccionesOrdenadas = menuData.sort((a, b) => a.order - b.order);
    
    // Cargar productos para cada sección
    for (const seccion of seccionesOrdenadas) {
      const productosResponse = await fetch(`_products/${seccion.title.toLowerCase()}/index.json`);
      const productos = await productosResponse.json();
      
      // Ordenar productos según el campo "order"
      const productosOrdenados = productos.sort((a, b) => a.order - b.order);
      
      // Renderizar productos en la sección correspondiente
      const sectionContent = document.querySelector(`#${seccion.title.toLowerCase()}-section .accordion-content`);
      
      // Limpiar contenido existente (excepto elementos especiales)
      const elementosEspeciales = sectionContent.querySelectorAll('.separadorCategoria, .leyendaPatys');
      sectionContent.innerHTML = '';
      elementosEspeciales.forEach(elemento => sectionContent.appendChild(elemento));
      
      // Agregar cada producto
      productosOrdenados.forEach(producto => {
        const itemDiv = document.createElement('div');
        itemDiv.className = 'item';
        
        // Si no está disponible, agregar una clase especial
        if (!producto.available) {
          itemDiv.classList.add('no-disponible');
        }
        
        itemDiv.innerHTML = `
          <div>
            <span class="itemNombre">${producto.title}</span>
            ${producto.description ? `<div class="itemDesc">${producto.description}</div>` : ''}
            ${!producto.available ? '<div class="no-disponible-label">NO DISPONIBLE</div>' : ''}
          </div>
          <span class="puntos"></span>
          <span class="precioBox">$${producto.price.toLocaleString()}</span>
          ${producto.available ? `<button class="btnAgregar" onclick="confirmar('${producto.title}', ${producto.price})">+</button>` : ''}
        `;
        
        sectionContent.insertBefore(itemDiv, sectionContent.firstChild);
      });
    }
  } catch (error) {
    console.error('Error al cargar productos:', error);
    // Si hay error al cargar desde Decap CMS, cargar productos estáticos
    cargarProductosEstaticos();
  }
}

// Función para cargar productos estáticos si falla Decap CMS
function cargarProductosEstaticos() {
  // Cargar productos estáticos aquí si es necesario
  console.log('Cargando productos estáticos...');
}

// Inicializar carruseles y productos cuando se carga la página
window.addEventListener('DOMContentLoaded', async () => {
  // Cargar carrusel del header
  await cargarImagenesCarrusel('headerCarrusel', 'pizza', 6);
  
  // Cargar carruseles de las secciones
  await cargarImagenesCarrusel('ofertasCarrusel', 'oferta', 3);
  await cargarImagenesCarrusel('pizzaCarrusel', 'pizza', 6);
  await cargarImagenesCarrusel('lomoCarrusel', 'lomo', 6);
  await cargarImagenesCarrusel('milaCarrusel', 'mila', 6);
  await cargarImagenesCarrusel('hambCarrusel', 'hamb', 6);
  await cargarImagenesCarrusel('patysCarrusel', 'patys', 6);
  
  // Cargar productos desde Decap CMS
  await cargarProductos();
  
  // Forzar la visualización del botón de editar si hay productos en el carrito
  actualizarUI();
});

// ---------- CARRITO ----------
function confirmar(nombre, precio) {
  tempProducto = { nombre, precio };
  document.getElementById('modalConfirm').classList.remove('oculto');
}
function confirmarSi() {
  if (tempProducto) {
    carrito.push(tempProducto);
    actualizarUI();
    tempProducto = null;
  }
  document.getElementById('modalConfirm').classList.add('oculto');
}
function confirmarNo() {
  tempProducto = null;
  document.getElementById('modalConfirm').classList.add('oculto');
}
function actualizarUI() {
  const cant = carrito.length;
  const total = carrito.reduce((sum, p) => sum + p.precio, 0);
  document.getElementById('carritoCant').textContent = cant;
  document.getElementById('totalBadge').textContent = `Total: $${total.toLocaleString()}`;
  const editarBtn = document.getElementById('editarBtn');
  
  if (cant > 0) {
    editarBtn.style.display = 'block';
    editarBtn.classList.add('visible');
    editarBtn.style.zIndex = '1000';
    console.log('Mostrando botón de editar carrito');
  } else {
    editarBtn.style.display = 'none';
    editarBtn.classList.remove('visible');
    console.log('Ocultando botón de editar carrito');
  }
}
function enviarWhatsApp() {
  if (carrito.length === 0) { alert('El carrito está vacío'); return; }
  let texto = `Hola, quiero hacer este pedido:\n`;
  let total = 0;
  carrito.forEach(p => {
    texto += `· ${p.nombre} $${p.precio.toLocaleString()}\n`;
    total += p.precio;
  });
  texto += `\nTotal: $${total.toLocaleString()}`;
  window.open(`https://wa.me/${NUMERO_WHATSAPP}?text=${encodeURIComponent(texto)}`);
}
function mostrarEditor() {
  const editor = document.getElementById('editorModal');
  const lista = document.getElementById('editorLista');
  lista.innerHTML = '';
  if (carrito.length === 0) {
    lista.innerHTML = '<p>El carrito está vacío</p>';
  } else {
    carrito.forEach((p, i) => {
      const div = document.createElement('div');
      div.className = 'editorItem';
      div.innerHTML = `<span>${p.nombre} - $${p.precio.toLocaleString()}</span><button onclick="quitarDelCarrito(${i})">Quitar</button>`;
      lista.appendChild(div);
    });
  }
  editor.classList.remove('oculto');
}
function quitarDelCarrito(index) {
  carrito.splice(index, 1);
  actualizarUI();
  mostrarEditor(); // refrescar lista
}
function cerrarEditor() {
  document.getElementById('editorModal').classList.add('oculto');
}
// Inicializar
actualizarUI();
</script>

</body>
</html>